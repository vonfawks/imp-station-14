- type: entity
  abstract: true
  parent: BaseItem
  id: ProjectileGrenadeBase
  components:
  - type: Appearance
  - type: Damageable
    damageContainer: Inorganic
  - type: DeleteOnTrigger
    keysIn:
    - timer
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 10
      behaviors:
      - !type:TriggerBehavior
        keyOut: timer # explode immediately
  - type: ContainerContainer
    containers:
      cluster-payload: !type:Container
  - type: ProjectileGrenade
  - type: AnimationPlayer
  - type: GenericVisualizer #imp our take on the layers
    visuals:
      enum.Trigger.TriggerVisuals.VisualState:
        enum.ConstructionVisuals.Layer:
          Primed: { state: primed }
          Unprimed: { state: icon }
        triggerlight:
          Primed: { visible: true }
          Unprimed: { visible: false }    
#  - type: GenericVisualizer #imp - same as normal grenades, this is the Wizden take on the layers, commented out in place of our's to add the unshaded layer
#    visuals:
#      enum.Trigger.TriggerVisuals.VisualState:
#        enum.ConstructionVisuals.Layer:
#          Primed: { state: primed }
#          Unprimed: { state: icon }
  - type: Tag
    tags:
    - HandGrenade
  - type: Fixtures
    fixtures:
      fix1:
        shape: !type:PhysShapeCircle
          radius: 0.2
        density: 20 # derived from base_item
        mask:
        - ItemMask
        restitution: 0.3
        friction: 0.2

- type: entity
  parent: [ProjectileGrenadeBase, BaseSecurityContraband]
  id: GrenadeStinger
  name: stinger grenade
  description: A grenade that launches rubber projectiles, or sting balls, at high speeds in the hopes to stun a target. Stings like hell. #imp
  components:
  - type: Sprite
    sprite: _Impstation/Objects/Weapons/Grenades/stingergrenade.rsi #imp
    layers:
    - state: icon
      map: ["enum.TriggerVisualLayers.Base"]
    - state: primed-unshaded #imp the unshaded layer
      shader: unshaded
      visible: false
      map: ["triggerlight"]
  - type: ProjectileGrenade
    fillPrototype: PelletClusterRubber
    capacity: 30
  - type: EmitSoundOnTrigger
    keysIn:
    - timer
    sound:
      path: "/Audio/Weapons/Guns/Gunshots/batrifle.ogg" #imp; to sound like other projectile grenades
    positional: true
  - type: SpawnOnTrigger
    keysIn:
    - timer
    proto: GrenadeFlashEffectStun #imp
    predicted: true
  - type: TriggerOnUse
  - type: TimerTrigger
    initialBeepDelay: 0
    beepInterval: 2
    delay: 3.5
  - type: TimerTriggerVisuals
    primingSound:
      path: /Audio/Effects/countdown.ogg

- type: entity
  parent: [ProjectileGrenadeBase, BaseSyndicateContraband]
  id: GrenadeIncendiary
  name: incendiary grenade
  description: Guaranteed to light up the mood.
  components:
  - type: Sprite
    sprite: _Impstation/Objects/Weapons/Grenades/pyrogrenade.rsi #imp
    layers:
    - state: icon
      map: ["enum.TriggerVisualLayers.Base"]
    - state: primed-unshaded #imp the unshaded layer
      shader: unshaded
      visible: false
      map: ["triggerlight"]
  - type: SpawnOnTrigger #imp; causes light when it explodes
    keysIn:
    - timer
    proto: GrenadeFlashEffectPyro
    predicted: true
  - type: ProjectileGrenade
    fillPrototype: PelletClusterIncendiary
    capacity: 30
  - type: TriggerOnUse
  - type: TimerTrigger
    beepSound:
      path: "/Audio/Effects/beep1.ogg"
      params:
        volume: 5
    initialBeepDelay: 0
    beepInterval: 2
    delay: 3.5
  - type: EmitSoundOnTrigger
    keysIn:
    - timer
    sound:
      path: "/Audio/Weapons/Guns/Gunshots/batrifle.ogg"
    positional: true
  - type: StaticPrice
    price: 1500

- type: entity
  parent: [ProjectileGrenadeBase, BaseSyndicateContraband]
  id: GrenadeShrapnel
  name: shrapnel grenade
  description: Launches a deadly spray of shrapnel and fragmentation that rip through any unfortunate soul in the area of effect. #imp
  components:
  - type: Sprite
    sprite: _Impstation/Objects/Weapons/Grenades/shrapnelgrenade.rsi #imp
    layers:
    - state: icon
      map: ["enum.TriggerVisualLayers.Base"]
    - state: primed-unshaded #imp the unshaded layer
      shader: unshaded
      visible: false
      map: ["triggerlight"]
  - type: ProjectileGrenade
    fillPrototype: PelletClusterLethal
    capacity: 30
  - type: TriggerOnUse
  - type: SpawnOnTrigger #imp; causes light when it explodes
    keysIn:
    - timer
    proto: GrenadeFlashEffect
    predicted: true
  - type: TimerTrigger
    beepSound:
      path: "/Audio/Effects/beep1.ogg"
      params:
        volume: 5
    initialBeepDelay: 0
    beepInterval: 2
    delay: 3.5
  - type: EmitSoundOnTrigger
    keysIn:
    - timer
    sound:
      path: "/Audio/Weapons/Guns/Gunshots/batrifle.ogg"
    positional: true
  - type: StaticPrice
    price: 1500
